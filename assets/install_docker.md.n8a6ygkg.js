import{_ as i,c as a,ae as t,o as e}from"./chunks/framework.ilBJtLV6.js";const c=JSON.parse('{"title":"🐳 Docker 部署 MiaoSpeed","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"install/docker.md","filePath":"install/docker.md","lastUpdated":1755327566000}'),n={name:"install/docker.md"};function h(l,s,p,k,d,r){return e(),a("div",null,s[0]||(s[0]=[t(`<h1 id="🐳-docker-部署-miaospeed" tabindex="-1">🐳 Docker 部署 MiaoSpeed <a class="header-anchor" href="#🐳-docker-部署-miaospeed" aria-label="Permalink to &quot;🐳 Docker 部署 MiaoSpeed&quot;">​</a></h1><h2 id="📦-docker-镜像" tabindex="-1">📦 Docker 镜像 <a class="header-anchor" href="#📦-docker-镜像" aria-label="Permalink to &quot;📦 Docker 镜像&quot;">​</a></h2><p>MiaoSpeed 提供两个版本镜像：</p><ul><li><code>latest</code> → 稳定版</li><li><code>beta</code> → 最新测试版（推荐）</li></ul><h3 id="拉取镜像" tabindex="-1">拉取镜像 <a class="header-anchor" href="#拉取镜像" aria-label="Permalink to &quot;拉取镜像&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> moshaoli688/miaospeed:latest</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> moshaoli688/miaospeed:beta</span></span></code></pre></div><h3 id="预构建镜像-推荐国内用户" tabindex="-1">预构建镜像（推荐国内用户） <a class="header-anchor" href="#预构建镜像-推荐国内用户" aria-label="Permalink to &quot;预构建镜像（推荐国内用户）&quot;">​</a></h3><p>我们已提供预构建好的离线镜像，可通过 <code>curl</code> 下载后导入：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://down.miaospeed.com/containers/miaospeed_amd64_latest.tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/miaospeed.tar.gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> load</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/miaospeed.tar.gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/miaospeed.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://down.miaospeed.com/containers/watchtower_amd64_latest.tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/watchtower_latest.tar.gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> load</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/watchtower_latest.tar.gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/watchtower_latest.tar.gz</span></span></code></pre></div><blockquote><p>📌 其他架构：</p><ul><li><a href="https://down.miaospeed.com/containers/miaospeed_arm64_latest.tar" target="_blank" rel="noreferrer">miaospeed_arm64_latest.tar</a></li><li><a href="https://down.miaospeed.com/containers/miaospeed_arm_latest.tar" target="_blank" rel="noreferrer">miaospeed_arm_latest.tar</a></li></ul></blockquote><hr><h2 id="⚙️-环境变量" tabindex="-1">⚙️ 环境变量 <a class="header-anchor" href="#⚙️-环境变量" aria-label="Permalink to &quot;⚙️ 环境变量&quot;">​</a></h2><p>可用的环境变量如下：</p><table tabindex="0"><thead><tr><th>变量</th><th>说明</th></tr></thead><tbody><tr><td><code>MIAOSPEED_META</code></td><td>启用 META，默认不设置即可</td></tr><tr><td><code>MIAOSPEED_MTLS</code></td><td>启用 mTLS，值为 <code>1</code></td></tr><tr><td><code>MIAOSPEED_TOKEN</code></td><td>验证 Token</td></tr><tr><td><code>MIAOSPEED_PATH</code></td><td>设置 WebSocket 路径（仅限 beta 版）</td></tr><tr><td><code>MIAOSPEED_WHITELIST</code></td><td>白名单，格式：<code>1111,2222,3333</code></td></tr><tr><td><code>MIAOSPEED_NOSPEED</code></td><td>禁止测速，值为 <code>1</code></td></tr><tr><td><code>MIAOSPEED_CONNTHREAD</code></td><td>线程池大小，默认 64；低内存建议 ≤32</td></tr><tr><td><code>MIAOSPEED_MMDB</code></td><td>启用 MMDB</td></tr></tbody></table><hr><h2 id="🚀-一键部署" tabindex="-1">🚀 一键部署 <a class="header-anchor" href="#🚀-一键部署" aria-label="Permalink to &quot;🚀 一键部署&quot;">​</a></h2><p>我们提供了 <strong>一键部署脚本</strong>，会自动拉取镜像并运行：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -fsSL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://sh.msl.la/docker/install-lite.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --net=host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --port=20221</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --token=你的token</span></span></code></pre></div><p>参数说明：</p><ul><li><code>--net=host|bridge</code> → 网络模式（默认 host）</li><li><code>--port=20221</code> → 容器对外暴露端口</li><li><code>--token=xxx</code> → 指定 Token（不填自动生成）</li><li><code>--path=/usr/local/bin/miaospeed</code> → 自定义路径（可选）</li></ul><hr><h2 id="🖐-手工部署" tabindex="-1">🖐 手工部署 <a class="header-anchor" href="#🖐-手工部署" aria-label="Permalink to &quot;🖐 手工部署&quot;">​</a></h2><h3 id="docker-run" tabindex="-1">Docker Run <a class="header-anchor" href="#docker-run" aria-label="Permalink to &quot;Docker Run&quot;">​</a></h3><p>默认端口：<code>9966</code></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 9966:9966</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --name=miaospeed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --restart=always</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MIAOSPEED_MTLS=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MIAOSPEED_TOKEN=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">你的toke</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  moshaoli688/miaospeed:beta</span></span></code></pre></div><h3 id="docker-compose" tabindex="-1">Docker Compose <a class="header-anchor" href="#docker-compose" aria-label="Permalink to &quot;Docker Compose&quot;">​</a></h3><p>默认端口：<code>9966</code></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  miaospeed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">moshaoli688/miaospeed:beta</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    restart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">always</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;9966:9966&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TZ=Asia/Shanghai</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MIAOSPEED_META=1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MIAOSPEED_MTLS=1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MIAOSPEED_WHITELIST=1111,2222,3333</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    mem_limit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">2048m</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      driver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">json-file</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        max-size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;200m&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        max-file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;3&#39;</span></span></code></pre></div><p>启动：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre></div><hr><h2 id="🛠-更新-mmdb" tabindex="-1">🛠 更新 MMDB <a class="header-anchor" href="#🛠-更新-mmdb" aria-label="Permalink to &quot;🛠 更新 MMDB&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> miaospeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./miaospeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> misc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -maxmind-update-license</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 你的key</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> miaospeed</span></span></code></pre></div>`,33)]))}const F=i(n,[["render",h]]);export{c as __pageData,F as default};
